services:
  test-service:
    build:
      repo: test
      context: ./app
    volumes:
      '/test/vol': test-vol
      '/test/vol-global': global-test-vol
      '/test/repo': $repos/test
    networks:
      - test-net
      - test-global-net
        
  common-service:
    image: ealen/echo-server
    global: true
    networks:
      - test-global-net

  ubuntu-nc:
    autostart: true
    build:
      repo: ubuntu-with-nc
    command: ["nc", "-l", "-p", "8080"]
    ports:
      - 8080:8080
    restart: always

volumes:
  test-vol:
  global-test-vol:
    global: true

networks:
  test-net:
  test-global-net:
    global: true
